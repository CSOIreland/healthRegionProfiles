# #sample dataset if running tests
#Sample <- sample(1:nrow(EDWGUIDAC),1)
#EDWGUIDAC <- EDWGUIDAC[Sample,]
EDWGUIDAC <- EDWGUIDAC%>%group_by(CHN)%>%
filter(row_number()==1)
# Read and Format PX Stat Files
source(paste0(getwd(),"/scripts/1_ReadAndFormatPXStat.R"))
# calculate SAPS Percentages
source(paste0(getwd(),"/scripts/2_SAPSPercentages.R"))
# create an empty list for errors, to be filled later
ErrorList <- list()
i<-2
ED <- as.character(EDWGUIDAC$CHN[i])
EDLC <- as.character(EDWGUIDAC$EDLC[i])
AC <- EDWGUIDAC$Region[i]
ACLC <- as.character(EDWGUIDAC$ACLC[i])
IHA <- EDWGUIDAC$IHA[i]
IHALC <- as.character(EDWGUIDAC$IHALC[i])
#Create a truncated version of ED so that tables and plots remain consistent
EDForTables <- str_trunc(ED, 25)
EDForTables <- str_replace_all(EDForTables, "[^[:alnum:]]\\,", " ")
EDName <- make.names(ED)
EDName <- gsub("\\.","-", EDName)
#Create a truncated version of AC so that tables and plots remain consistent
ACForTables <- str_trunc(AC, 25)
ACForTables <- str_replace_all(ACForTables, "[^[:alnum:]]\\,", " ")
ACForTablesShort <- str_trunc(AC, 15)
ACForTablesShort <- str_replace_all(ACForTablesShort , "[^[:alnum:]]\\,", " ")
ACName <- make.names(AC)
ACName <-  gsub("\\.","-", ACName)
# Title for the markdown/html
TitleForRMD <- paste0("IHA Health Profile - ", ED)
# link to map for ED
#EDMapLink <- paste0("../inputs/exportededmaps/",EDGUID,".jpg")
# Run through Subfiles
source(paste0(getwd(),"/scripts/3_Population.R"))
source(paste0(getwd(),"/scripts/4_Carers.R"))
source(paste0(getwd(),"/scripts/5_GeneralHealth.R"))
source(paste0(getwd(),"/scripts/6_Disability.R"))
source(paste0(getwd(),"/scripts/7_Smoking.R"))
source(paste0(getwd(),"/scripts/8_Education.R"))
source(paste0(getwd(),"/scripts/9_PrincipleEconomicStatus.R"))
source(paste0(getwd(),"/scripts/10_Families.R"))
source(paste0(getwd(),"/scripts/11_Birthplace.R"))
source(paste0(getwd(),"/scripts/12_Volunteering.R"))
source(paste0(getwd(),"/scripts/13_SocialClass.R"))
source(paste0(getwd(),"/scripts/14_Households.R"))
source(paste0(getwd(),"/scripts/15_RenewableEnergy.R"))
source(paste0(getwd(),"/scripts/16_Travel.R"))
source(paste0(getwd(),"/scripts/17_KeyPointsAndOtherCalcs.R"))
source(paste0(getwd(),"/scripts/18_SAPS.R"))
setwd(paste0(getwd(),"/scripts"))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#EDProfile pdf Link for RMD
# EDLinkPDF<- paste0("<font size=\"5\"><a href=\"https://cdn.jsdelivr.net/gh/CSOIreland/edprofiles@resources/2022/health/pdf/",i,"-",EDLC,"-ac-",ACLC,".pdf\""," style=\"text-decoration: none\">A more detailed and print friendly pdf profile - with accompanying tables - is available here.</a></font>")
# EDLinkPDF
View(SAPSTotalRegionRanked[,c("ED","MalesCarersRanked","FemalesCarersRanked","T12_2_F","T12_2_M")])
View(SAPSTotalCHNRanked[,c("ED","MalesCarersRanked","FemalesCarersRanked","T12_2_F","T12_2_M")])
SAPSTotalCHNRanked <- SAPSPercentagesCHN%>%filter(ED!="State" & ED!="ignore"& ED!="ignore2"& ED!="Ignore"& ED!="Ignore2"& ED!="ignore3"& ED!="Ignore3")%>%mutate(PrimaryOrLower =T10_4_NFT +T10_4_PT,
DegreeOrHigher = T10_4_ODNDT + T10_4_HDPQT + T10_4_PDT + T10_4_DT,T1_1AGE0T,
ZeroTo14 = T1_1AGE1T+T1_1AGE2T+T1_1AGE3T+T1_1AGE4T+T1_1AGE5T+T1_1AGE6T+T1_1AGE7T
+T1_1AGE8T+T1_1AGE9T+T1_1AGE10T+T1_1AGE11T+T1_1AGE12T+T1_1AGE13T+T1_1AGE14T,
SixtyFiveP = T1_1AGE65_69T+T1_1AGE70_74T+T1_1AGE75_79T+T1_1AGE80_84T+T1_1AGEGE_85T,
BadVBadHealth = T12_3_BT + T12_3_VBT,
Unemployed = T8_1_STUT+T8_1_LTUT,
LoneParentsFamUnits =T4_3FOPMCT+T4_3FOPFCT,
OutsideIreland = T2_1UKBP+T2_1PLBP+T2_1INBP+T2_1EUBP+T2_1RWBP,
OnFootBicycle = T11_1_FT+T11_1_BIT)%>%mutate(
PrimaryOrLowerRanked =  dense_rank(desc(PrimaryOrLower)),
DegreeOrHigherRanked = dense_rank(desc(DegreeOrHigher)),
BadVBadHealthRanked = dense_rank(desc(BadVBadHealth)),
UnemployedRanked = dense_rank(desc(Unemployed)),
LoneParFamUnitRanked = dense_rank(desc(LoneParentsFamUnits)),
SmokingRanked = dense_rank(desc(T12_4_YES)),
LARanked = dense_rank(desc(T6_3_RLAH)),
OwnedOutrightRanked = dense_rank(desc(T6_3_OOH)),
OutsideIrelandRanked = dense_rank(desc(OutsideIreland)),
UnskilledRanked = dense_rank(desc(T9_1_UST)),
ProfWorkersRanked = dense_rank(desc(T9_1_PWT)),
MalesDisabilityRanked = dense_rank(desc(T12_1_M)),
FemalesDisabilityRanked = dense_rank(desc(T12_1_F)),
MalesCarersRanked = dense_rank(desc(T12_2_M)),
FemalesCarersRanked = dense_rank(desc(T12_2_F)),
VolunteersRanked = dense_rank(desc(T7_1_VOL)),
RenewableEnergyRanked = dense_rank(desc(T6_10_NORE)),
OnFootBicycleRanked = dense_rank(desc(OnFootBicycle)),
CarDriverRanked = dense_rank(desc(T11_1_CDT)),
ZeroTo14Ranked = dense_rank(desc(ZeroTo14)),
SixtyFivePRanked = dense_rank(desc(ZeroTo14))
)
View(SAPSTotalCHNRanked[,c("ED","MalesCarersRanked","FemalesCarersRanked","T12_2_F","T12_2_M")])
View(SAPSTotalCHNRanked[,c("ED","T9_1_UST")])
SAPSTotalCHNRanked
PrimaryOrLowerRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHNIHA)>1,"Joint","Not Joint")
SAPSTotalCHNIHARanked2 <- SAPSTotalCHNIHARanked[SAPSTotalCHNIHARanked$ED == ED,]
PrimaryOrLowerRankedCHNIHA <- SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked
DegreeOrHigherRankedCHNIHA <- SAPSTotalCHNIHARanked2$DegreeOrHigherRanked
BadVBadHealthRankedCHNIHA <- SAPSTotalCHNIHARanked2$BadVBadHealthRanked
UnemployedRankedCHNIHA  <- SAPSTotalCHNIHARanked2$UnemployedRanked
LoneParFamUnitRankedCHNIHA <- SAPSTotalCHNIHARanked2$LoneParFamUnitRanked
SmokingRankedCHNIHA <- SAPSTotalCHNIHARanked2$SmokingRanked
LARankedCHNIHA <- SAPSTotalCHNIHARanked2$LARanked
OwnedOutrightRankedCHNIHA <- SAPSTotalCHNIHARanked2$OwnedOutrightRanked
OutsideIrelandRankedCHNIHA  <- SAPSTotalCHNIHARanked2$OutsideIrelandRanked
UnskilledRankedCHNIHA <-  SAPSTotalCHNIHARanked2$UnskilledRanked
ProfWorkersRankedCHNIHA <- SAPSTotalCHNIHARanked2$ProfWorkersRanked
MalesDisabilityRankedCHNIHA <- SAPSTotalCHNIHARanked2$MalesDisabilityRanked
FemalesDisabilityRankedCHNIHA <- SAPSTotalCHNIHARanked2$FemalesDisabilityRanked
MalesCarersRankedCHNIHA <- SAPSTotalCHNIHARanked2$MalesCarersRanked
FemalesCarersRankedCHNIHA <- SAPSTotalCHNIHARanked2$FemalesCarersRanked
VolunteersRankedCHNIHA  <- SAPSTotalCHNIHARanked2$VolunteersRanked
RenewableEnergyRankedCHNIHA <- SAPSTotalCHNIHARanked2$RenewableEnergyRanked
OnFootBicycleRankedCHNIHA <- SAPSTotalCHNIHARanked2$OnFootBicycleRanked
CarDriverRankedCHNIHA <- SAPSTotalCHNIHARanked2$CarDriverRanked
ZeroTo14RankedCHNIHA <- SAPSTotalCHNIHARanked2$ZeroTo14Ranked
SixtyFivePRankedCHNIHA <- SAPSTotalCHNIHARanked2$SixtyFivePRanked
PrimaryOrLowerRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHNIHA)>1,"Joint","Not Joint")
PrimaryOrLowerRankedCHNIHAJoint
PrimaryOrLowerRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHNIHA)>1,"Joint","Not Joint")
DegreeOrHigherRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$DegreeOrHigherRanked == DegreeOrHigherRankedCHNIHA)>1,"Joint","Not Joint")
BadVBadHealthRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$BadVBadHealthRanked == BadVBadHealthRankedCHNIHA)>1,"Joint","Not Joint")
UnemployedRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$UnemployedRanked == UnemployedRankedCHNIHA)>1,"Joint","Not Joint")
LoneParFamUnitRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$LoneParFamUnitRanked == LoneParFamUnitRankedCHNIHA)>1,"Joint","Not Joint")
SmokingRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$SmokingRanked  == SmokingRankedCHNIHA)>1,"Joint","Not Joint")
LARankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$LARanked  == LARankedCHNIHA)>1,"Joint","Not Joint")
OwnedOutrightRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$OwnedOutrightRanked == OwnedOutrightRankedCHNIHA)>1,"Joint","Not Joint")
OutsideIrelandRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$OutsideIrelandRanked == OutsideIrelandRankedCHNIHA)>1,"Joint","Not Joint")
UnskilledRankedCHNIHAJoint <-  ifelse(sum(SAPSTotalCHNIHARanked2$UnskilledRanked  == UnskilledRankedCHNIHA)>1,"Joint","Not Joint")
ProfWorkersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$ProfWorkersRanked == ProfWorkersRankedCHNIHA)>1,"Joint","Not Joint")
MalesDisabilityRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$MalesDisabilityRanked == MalesDisabilityRankedCHNIHA)>1,"Joint","Not Joint")
FemalesDisabilityRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$FemalesDisabilityRanked == FemalesDisabilityRankedCHNIHA)>1,"Joint","Not Joint")
MalesCarersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$MalesCarersRanked == MalesCarersRankedCHNIHA)>1,"Joint","Not Joint")
FemalesCarersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$FemalesCarersRanked == FemalesCarersRankedCHNIHA)>1,"Joint","Not Joint")
VolunteersRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$VolunteersRanked == VolunteersRankedCHNIHA)>1,"Joint","Not Joint")
RenewableEnergyRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$RenewableEnergyRanked  == RenewableEnergyRankedCHNIHA)>1,"Joint","Not Joint")
OnFootBicycleRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$OnFootBicycleRanked  == OnFootBicycleRankedCHNIHA)>1,"Joint","Not Joint")
CarDriverRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$CarDriverRanked  == CarDriverRankedCHNIHA)>1,"Joint","Not Joint")
ZeroTo14RankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$ZeroTo14Ranked  == ZeroTo14RankedCHNIHA)>1,"Joint","Not Joint")
SixtyFivePRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$SixtyFivePRanked == SixtyFivePRankedCHNIHA)>1,"Joint","Not Joint")
PrimaryOrLowerRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHN)>1,"Joint","Not Joint")
################################
SAPSTotalCHNRanked2 <- SAPSTotalCHNRanked[SAPSTotalCHNRanked$ED == ED,]
PrimaryOrLowerRankedCHN <- SAPSTotalCHNRanked2$PrimaryOrLowerRanked
DegreeOrHigherRankedCHN <- SAPSTotalCHNRanked2$DegreeOrHigherRanked
BadVBadHealthRankedCHN <- SAPSTotalCHNRanked2$BadVBadHealthRanked
UnemployedRankedCHN  <- SAPSTotalCHNRanked2$UnemployedRanked
LoneParFamUnitRankedCHN <- SAPSTotalCHNRanked2$LoneParFamUnitRanked
SmokingRankedCHN <- SAPSTotalCHNRanked2$SmokingRanked
LARankedCHN <- SAPSTotalCHNRanked2$LARanked
OwnedOutrightRankedCHN <- SAPSTotalCHNRanked2$OwnedOutrightRanked
OutsideIrelandRankedCHN  <- SAPSTotalCHNRanked2$OutsideIrelandRanked
UnskilledRankedCHN <-  SAPSTotalCHNRanked2$UnskilledRanked
ProfWorkersRankedCHN <- SAPSTotalCHNRanked2$ProfWorkersRanked
MalesDisabilityRankedCHN <- SAPSTotalCHNRanked2$MalesDisabilityRanked
FemalesDisabilityRankedCHN <- SAPSTotalCHNRanked2$FemalesDisabilityRanked
MalesCarersRankedCHN <- SAPSTotalCHNRanked2$MalesCarersRanked
FemalesCarersRankedCHN <- SAPSTotalCHNRanked2$FemalesCarersRanked
VolunteersRankedCHN  <- SAPSTotalCHNRanked2$VolunteersRanked
RenewableEnergyRankedCHN <- SAPSTotalCHNRanked2$RenewableEnergyRanked
OnFootBicycleRankedCHN <- SAPSTotalCHNRanked2$OnFootBicycleRanked
CarDriverRankedCHN <- SAPSTotalCHNRanked2$CarDriverRanked
ZeroTo14RankedCHN <- SAPSTotalCHNRanked2$ZeroTo14Ranked
SixtyFivePRankedCHN <- SAPSTotalCHNRanked2$SixtyFivePRanked
PrimaryOrLowerRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHN)>1,"Joint","Not Joint")
DegreeOrHigherRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$DegreeOrHigherRanked == DegreeOrHigherRankedCHN)>1,"Joint","Not Joint")
BadVBadHealthRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$BadVBadHealthRanked == BadVBadHealthRankedCHN)>1,"Joint","Not Joint")
UnemployedRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$UnemployedRanked == UnemployedRankedCHN)>1,"Joint","Not Joint")
LoneParFamUnitRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$LoneParFamUnitRanked == LoneParFamUnitRankedCHN)>1,"Joint","Not Joint")
SmokingRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$SmokingRanked  == SmokingRankedCHN)>1,"Joint","Not Joint")
LARankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$LARanked  == LARankedCHN)>1,"Joint","Not Joint")
OwnedOutrightRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$OwnedOutrightRanked == OwnedOutrightRankedCHN)>1,"Joint","Not Joint")
OutsideIrelandRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$OutsideIrelandRanked == OutsideIrelandRankedCHN)>1,"Joint","Not Joint")
UnskilledRankedCHNJoint <-  ifelse(sum(SAPSTotalCHNRanked2$UnskilledRanked  == UnskilledRankedCHN)>1,"Joint","Not Joint")
ProfWorkersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$ProfWorkersRanked == ProfWorkersRankedCHN)>1,"Joint","Not Joint")
MalesDisabilityRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$MalesDisabilityRanked == MalesDisabilityRankedCHN)>1,"Joint","Not Joint")
FemalesDisabilityRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$FemalesDisabilityRanked == FemalesDisabilityRankedCHN)>1,"Joint","Not Joint")
MalesCarersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$MalesCarersRanked == MalesCarersRankedCHN)>1,"Joint","Not Joint")
FemalesCarersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$FemalesCarersRanked == FemalesCarersRankedCHN)>1,"Joint","Not Joint")
VolunteersRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$VolunteersRanked == VolunteersRankedCHN)>1,"Joint","Not Joint")
RenewableEnergyRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$RenewableEnergyRanked  == RenewableEnergyRankedCHN)>1,"Joint","Not Joint")
OnFootBicycleRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$OnFootBicycleRanked  == OnFootBicycleRankedCHN)>1,"Joint","Not Joint")
CarDriverRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$CarDriverRanked  == CarDriverRankedCHN)>1,"Joint","Not Joint")
ZeroTo14RankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$ZeroTo14Ranked  == ZeroTo14RankedCHN)>1,"Joint","Not Joint")
SixtyFivePRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$SixtyFivePRanked == SixtyFivePRankedCHN)>1,"Joint","Not Joint")
NumCHNs <- length(unique(SAPSHRLookup$CHN))
NumCHNIHA <- length(unique(SAPSHRLookup$CHN[SAPSHRLookup$IHA == IHA]))
SAPSPercentagesEDACState <- SAPSPercentages[SAPSPercentages$ED == ED | 	SAPSPercentages$ED == AC|SAPSPercentages$ED == IHA|SAPSPercentages$ED == "State",]
#SAPSPercentagesEDACState <- SAPSPercentagesEDACState[!duplicated(SAPSPercentagesEDACState$GUID),]
# Add ED var
SAPSPercentagesEDACState$ED[SAPSPercentagesEDACState$ED == "State"] <- "State"
SAPSPercentagesEDACState$ED[SAPSPercentagesEDACState$ED == ED] <- "CHN"
SAPSPercentagesEDACState$ED[SAPSPercentagesEDACState$ED == IHA] <- "IHA"
SAPSPercentagesEDACState$ED[SAPSPercentagesEDACState$ED == AC] <- "HR"
# Transpose the dataframe so tables can be more easily created
SAPSTransposed <- as.data.frame(t(SAPSPercentagesEDACState))
colnames(SAPSTransposed) <- SAPSTransposed[rownames(SAPSTransposed) == "ED",]
SAPSTransposed <- SAPSTransposed[rownames(SAPSTransposed)!="ED" & rownames(SAPSTransposed)!="ED", ]
SAPSTransposed$Lookup <- rownames(SAPSTransposed)
# SAPSTransposed$AbsDiff <- round(as.numeric(SAPSTransposed$ED) - as.numeric(SAPSTransposed$State),1)
# SAPSTransposed$RelDiff <- round(as.numeric(SAPSTransposed$ED)*100/as.numeric(SAPSTransposed$AC) - 100,1)
# merge with glossary file so appropriate tables can be created using columns from glossary
SAPSWGlossary <- merge(SAPSTransposed, SAPSGlossary, by.x = "Lookup", by.y = "ColName", all.x=T)
SAPSWGlossary[is.na(SAPSWGlossary)] <- "Missing"
# Columns to select for each dataframe
ColsToSelect <- c("Label", "CHN","IHA", "HR","State", "LatexTableTitle","Rank")
SAPSWGlossary$LatexTableTitle <- factor(SAPSWGlossary$LatexTableTitle,levels = unique(SAPSWGlossary$LatexTableTitle))
# Split the dataframes based on latex table title
SplitDataframes <- SAPSWGlossary %>%
dplyr::select(all_of(ColsToSelect)) %>%
group_split(LatexTableTitle, .keep = F)
# Naming the list elements with make.names of the values in  latextabletitle column
names(SplitDataframes) <- make.names(unique(SAPSWGlossary$LatexTableTitle))
# Creating individual dataframes from the list
list2env(SplitDataframes, envir = .GlobalEnv)
#Ordering the tables by the "rank column"
Education..percentage.of.those.aged.15.. <- as.data.frame(Education..percentage.of.those.aged.15..)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Employment..percentage.of.those.aged.15.. <- as.data.frame(Employment..percentage.of.those.aged.15..)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Employment..percentage.of.those.at.work. <- as.data.frame(Employment..percentage.of.those.at.work.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Families..percentage.of.family.units. <- as.data.frame(Families..percentage.of.family.units.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Health..percentage.of.population. <- as.data.frame(Health..percentage.of.population.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Household.Composition..percentage.of.private.households. <- as.data.frame(Household.Composition..percentage.of.private.households.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Housing..percentage.of.households. <- as.data.frame(Housing..percentage.of.households.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Housing..percentage.of.permanent.dwellings. <- as.data.frame(Housing..percentage.of.permanent.dwellings.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Housing..percentage.of.permanent.private.households. <- as.data.frame(Housing..percentage.of.permanent.private.households.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Housing..percentage.of.private.households. <- as.data.frame(Housing..percentage.of.private.households.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Marital.Status..percentage.of.population. <- as.data.frame(Marital.Status..percentage.of.population.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Migration.and.Ethnicity..percentage.of.population. <- as.data.frame(Migration.and.Ethnicity..percentage.of.population.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Migration.and.Ethnicity..percentage.of.usually.resident.population. <- as.data.frame(Migration.and.Ethnicity..percentage.of.usually.resident.population.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Occupation..percentage.of.those.at.work.or.unemployed. <- as.data.frame(Occupation..percentage.of.those.at.work.or.unemployed.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Social.Class..percentage.of.population... <- as.data.frame(Social.Class..percentage.of.population...)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Socio.economic.group.of.reference.person..percentage.of.private.households... <- as.data.frame(Socio.economic.group.of.reference.person..percentage.of.private.households...)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Transport..percentage.of.population.aged.5.years.and.over. <- as.data.frame(Transport..percentage.of.population.aged.5.years.and.over.)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Other <- as.data.frame(Other)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
Age1 <- as.data.frame(Age1)%>%mutate_at("Rank", as.numeric)%>%arrange(Rank)
# refactoring the age column of the age table
Age1$AgeNew <- ifelse(Age1$Label == "Age 0 - Total"|Age1$Label=="Age 1 - Total"|Age1$Label=="Age 2 - Total"|Age1$Label=="Age 3 - Total"|Age1$Label=="Age 4 - Total"|Age1$Label == "Age 5 - Total"|Age1$Label=="Age 6 - Total"|Age1$Label=="Age 7 - Total"|Age1$Label=="Age 8 - Total"|Age1$Label=="Age 9 - Total"|Age1$Label == "Age 10 - Total"|Age1$Label=="Age 11 - Total"|Age1$Label=="Age 12 - Total"|Age1$Label=="Age 13 - Total"|Age1$Label=="Age 14 - Total", "0-14",
ifelse(Age1$Label=="Age 15 - Total"|Age1$Label=="Age 16 - Total"|Age1$Label=="Age 17 - Total"|Age1$Label=="Age 18 - Total"|Age1$Label=="Age 19 - Total"|Age1$Label == "Age 20 - 24 - Total"|Age1$Label=="Age 25 - 29 - Total"|Age1$Label=="Age 30 - 34 - Total"|Age1$Label=="Age 35 - 39 - Total"|Age1$Label=="Age 40 - 44 - Total"|Age1$Label == "Age 45 - 49 - Total"|Age1$Label=="Age 50 - 54 - Total"|Age1$Label=="Age 55 - 59 - Total"|Age1$Label=="Age 60 - 64 - Total", "15-64",
ifelse(Age1$Label == "Age 65 - 69 - Total"|Age1$Label=="Age 70 - 74 - Total"|Age1$Label == "Age 75 - 79 - Total"|Age1$Label=="Age 80 - 84 - Total"|Age1$Label == "Age 85 and over - Total", "65+", "Missing")))
#changing format of Age columns so rank works successfully
Age1$CHN <- as.numeric(Age1$CHN)
Age1$HR <- as.numeric(Age1$HR)
Age1$IHA <- as.numeric(Age1$IHA)
Age1$State <- as.numeric(Age1$State)
Age1$Rank <- as.character(Age1$Rank)
Age2 <- Age1%>%group_by(AgeNew)%>%dplyr::summarise(across(where(is.numeric), sum), across(where(is.character), ~first(.)))
Age2$Rank <- as.numeric(Age2$Rank)
Age2 <- Age2[order(Age2$Rank),]
# changing the labels of the transport tables
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare on foot", "On Foot", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Bicycle", "By Bicycle", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Bus, minibus or coach", "By Bus, minibus or coach", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Train, DART or LUAS", "By Train, DART or LUAS", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Motorcycle or scooter", "By Motorcycle or scooter", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Car driver", "Car driver", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Car passenger", "Car passenger", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Van", "By Van", Transport..percentage.of.population.aged.5.years.and.over.$Label)
Transport..percentage.of.population.aged.5.years.and.over.$Label <- gsub("Travel to work, school, college or childcare by Other (incl. lorry)", "By Other (incl. lorry)", Transport..percentage.of.population.aged.5.years.and.over.$Label, fixed=T)
####Ranking
SAPSPercentagesRegion <- SAPSPercentages%>%filter(RegionType == "HR")
SAPSPercentagesIHA <- SAPSPercentages%>%filter(RegionType == "IHA")
SAPSPercentagesCHN <- SAPSPercentages%>%filter(RegionType == "CHN")
CHNsInIHA <- SAPSHRLookup$CHN[SAPSHRLookup$IHA == IHA]
SAPSPercentagesCHNIHA <- SAPSPercentages%>%filter(RegionType == "CHN" & ED %in% CHNsInIHA)
SAPSTotalRegionRanked <- SAPSPercentagesRegion%>%filter(ED!="State" & ED!="ignore"& ED!="ignore2"& ED!="Ignore"& ED!="Ignore2"& ED!="ignore3"& ED!="Ignore3")%>%mutate(PrimaryOrLower =T10_4_NFT +T10_4_PT,
DegreeOrHigher = T10_4_ODNDT + T10_4_HDPQT + T10_4_PDT + T10_4_DT,
ZeroTo14 = T1_1AGE1T+T1_1AGE2T+T1_1AGE3T+T1_1AGE4T+T1_1AGE5T+T1_1AGE6T+T1_1AGE7T
+T1_1AGE8T+T1_1AGE9T+T1_1AGE10T+T1_1AGE11T+T1_1AGE12T+T1_1AGE13T+T1_1AGE14T,
SixtyFiveP = T1_1AGE65_69T+T1_1AGE70_74T+T1_1AGE75_79T+T1_1AGE80_84T+T1_1AGEGE_85T,
BadVBadHealth = T12_3_BT + T12_3_VBT,
Unemployed = T8_1_STUT+T8_1_LTUT,
LoneParentsFamUnits =T4_3FOPMCT+T4_3FOPFCT,
OutsideIreland = T2_1UKBP+T2_1PLBP+T2_1INBP+T2_1EUBP+T2_1RWBP,
OnFootBicycle = T11_1_FT+T11_1_BIT)%>%mutate(
PrimaryOrLowerRanked =  dense_rank(desc(PrimaryOrLower)),
DegreeOrHigherRanked = dense_rank(desc(DegreeOrHigher)),
BadVBadHealthRanked = dense_rank(desc(BadVBadHealth)),
UnemployedRanked = dense_rank(desc(Unemployed)),
LoneParFamUnitRanked = dense_rank(desc(LoneParentsFamUnits)),
SmokingRanked = dense_rank(desc(T12_4_YES)),
LARanked = dense_rank(desc(T6_3_RLAH)),
OwnedOutrightRanked = dense_rank(desc(T6_3_OOH)),
OutsideIrelandRanked = dense_rank(desc(OutsideIreland)),
UnskilledRanked = dense_rank(desc(T9_1_UST)),
ProfWorkersRanked = dense_rank(desc(T9_1_PWT)),
MalesDisabilityRanked = dense_rank(desc(T12_1_M)),
FemalesDisabilityRanked = dense_rank(desc(T12_1_F)),
MalesCarersRanked = dense_rank(desc(T12_2_M)),
FemalesCarersRanked = dense_rank(desc(T12_2_F)),
VolunteersRanked = dense_rank(desc(T7_1_VOL)),
RenewableEnergyRanked = dense_rank(desc(T6_10_NORE)),
OnFootBicycleRanked = dense_rank(desc(OnFootBicycle)),
CarDriverRanked = dense_rank(desc(T11_1_CDT)),
ZeroTo14Ranked = dense_rank(desc(ZeroTo14)),
SixtyFivePRanked = dense_rank(desc(ZeroTo14))
)
SAPSTotalIHARanked <- SAPSPercentagesIHA%>%filter(ED!="State" & ED!="ignore"& ED!="ignore2"& ED!="Ignore"& ED!="Ignore2"& ED!="ignore3"& ED!="Ignore3")%>%mutate(PrimaryOrLower =T10_4_NFT +T10_4_PT,
DegreeOrHigher = T10_4_ODNDT + T10_4_HDPQT + T10_4_PDT + T10_4_DT,
ZeroTo14 = T1_1AGE1T+T1_1AGE2T+T1_1AGE3T+T1_1AGE4T+T1_1AGE5T+T1_1AGE6T+T1_1AGE7T
+T1_1AGE8T+T1_1AGE9T+T1_1AGE10T+T1_1AGE11T+T1_1AGE12T+T1_1AGE13T+T1_1AGE14T,
SixtyFiveP = T1_1AGE65_69T+T1_1AGE70_74T+T1_1AGE75_79T+T1_1AGE80_84T+T1_1AGEGE_85T,
BadVBadHealth = T12_3_BT + T12_3_VBT,
Unemployed = T8_1_STUT+T8_1_LTUT,
LoneParentsFamUnits =T4_3FOPMCT+T4_3FOPFCT,
OutsideIreland = T2_1UKBP+T2_1PLBP+T2_1INBP+T2_1EUBP+T2_1RWBP,
OnFootBicycle = T11_1_FT+T11_1_BIT)%>%mutate(
PrimaryOrLowerRanked =  dense_rank(desc(PrimaryOrLower)),
DegreeOrHigherRanked = dense_rank(desc(DegreeOrHigher)),
BadVBadHealthRanked = dense_rank(desc(BadVBadHealth)),
UnemployedRanked = dense_rank(desc(Unemployed)),
LoneParFamUnitRanked = dense_rank(desc(LoneParentsFamUnits)),
SmokingRanked = dense_rank(desc(T12_4_YES)),
LARanked = dense_rank(desc(T6_3_RLAH)),
OwnedOutrightRanked = dense_rank(desc(T6_3_OOH)),
OutsideIrelandRanked = dense_rank(desc(OutsideIreland)),
UnskilledRanked = dense_rank(desc(T9_1_UST)),
ProfWorkersRanked = dense_rank(desc(T9_1_PWT)),
MalesDisabilityRanked = dense_rank(desc(T12_1_M)),
FemalesDisabilityRanked = dense_rank(desc(T12_1_F)),
MalesCarersRanked = dense_rank(desc(T12_2_M)),
FemalesCarersRanked = dense_rank(desc(T12_2_F)),
VolunteersRanked = dense_rank(desc(T7_1_VOL)),
RenewableEnergyRanked = dense_rank(desc(T6_10_NORE)),
OnFootBicycleRanked = dense_rank(desc(OnFootBicycle)),
CarDriverRanked = dense_rank(desc(T11_1_CDT)),
ZeroTo14Ranked = dense_rank(desc(ZeroTo14)),
SixtyFivePRanked = dense_rank(desc(ZeroTo14))
)
SAPSTotalCHNRanked <- SAPSPercentagesCHN%>%filter(ED!="State" & ED!="ignore"& ED!="ignore2"& ED!="Ignore"& ED!="Ignore2"& ED!="ignore3"& ED!="Ignore3")%>%mutate(PrimaryOrLower =T10_4_NFT +T10_4_PT,
DegreeOrHigher = T10_4_ODNDT + T10_4_HDPQT + T10_4_PDT + T10_4_DT,T1_1AGE0T,
ZeroTo14 = T1_1AGE1T+T1_1AGE2T+T1_1AGE3T+T1_1AGE4T+T1_1AGE5T+T1_1AGE6T+T1_1AGE7T
+T1_1AGE8T+T1_1AGE9T+T1_1AGE10T+T1_1AGE11T+T1_1AGE12T+T1_1AGE13T+T1_1AGE14T,
SixtyFiveP = T1_1AGE65_69T+T1_1AGE70_74T+T1_1AGE75_79T+T1_1AGE80_84T+T1_1AGEGE_85T,
BadVBadHealth = T12_3_BT + T12_3_VBT,
Unemployed = T8_1_STUT+T8_1_LTUT,
LoneParentsFamUnits =T4_3FOPMCT+T4_3FOPFCT,
OutsideIreland = T2_1UKBP+T2_1PLBP+T2_1INBP+T2_1EUBP+T2_1RWBP,
OnFootBicycle = T11_1_FT+T11_1_BIT)%>%mutate(
PrimaryOrLowerRanked =  dense_rank(desc(PrimaryOrLower)),
DegreeOrHigherRanked = dense_rank(desc(DegreeOrHigher)),
BadVBadHealthRanked = dense_rank(desc(BadVBadHealth)),
UnemployedRanked = dense_rank(desc(Unemployed)),
LoneParFamUnitRanked = dense_rank(desc(LoneParentsFamUnits)),
SmokingRanked = dense_rank(desc(T12_4_YES)),
LARanked = dense_rank(desc(T6_3_RLAH)),
OwnedOutrightRanked = dense_rank(desc(T6_3_OOH)),
OutsideIrelandRanked = dense_rank(desc(OutsideIreland)),
UnskilledRanked = dense_rank(desc(T9_1_UST)),
ProfWorkersRanked = dense_rank(desc(T9_1_PWT)),
MalesDisabilityRanked = dense_rank(desc(T12_1_M)),
FemalesDisabilityRanked = dense_rank(desc(T12_1_F)),
MalesCarersRanked = dense_rank(desc(T12_2_M)),
FemalesCarersRanked = dense_rank(desc(T12_2_F)),
VolunteersRanked = dense_rank(desc(T7_1_VOL)),
RenewableEnergyRanked = dense_rank(desc(T6_10_NORE)),
OnFootBicycleRanked = dense_rank(desc(OnFootBicycle)),
CarDriverRanked = dense_rank(desc(T11_1_CDT)),
ZeroTo14Ranked = dense_rank(desc(ZeroTo14)),
SixtyFivePRanked = dense_rank(desc(ZeroTo14))
)
SAPSTotalCHNIHARanked <- SAPSPercentagesCHNIHA%>%filter(ED!="State" & ED!="ignore"& ED!="ignore2"& ED!="Ignore"& ED!="Ignore2"& ED!="ignore3"& ED!="Ignore3")%>%mutate(PrimaryOrLower =T10_4_NFT +T10_4_PT,
DegreeOrHigher = T10_4_ODNDT + T10_4_HDPQT + T10_4_PDT + T10_4_DT,
ZeroTo14 = T1_1AGE1T+T1_1AGE2T+T1_1AGE3T+T1_1AGE4T+T1_1AGE5T+T1_1AGE6T+T1_1AGE7T
+T1_1AGE8T+T1_1AGE9T+T1_1AGE10T+T1_1AGE11T+T1_1AGE12T+T1_1AGE13T+T1_1AGE14T,
SixtyFiveP = T1_1AGE65_69T+T1_1AGE70_74T+T1_1AGE75_79T+T1_1AGE80_84T+T1_1AGEGE_85T,
BadVBadHealth = T12_3_BT + T12_3_VBT,
Unemployed = T8_1_STUT+T8_1_LTUT,
LoneParentsFamUnits =T4_3FOPMCT+T4_3FOPFCT,
OutsideIreland = T2_1UKBP+T2_1PLBP+T2_1INBP+T2_1EUBP+T2_1RWBP,
OnFootBicycle = T11_1_FT+T11_1_BIT)%>%mutate(
PrimaryOrLowerRanked =  dense_rank(desc(PrimaryOrLower)),
DegreeOrHigherRanked = dense_rank(desc(DegreeOrHigher)),
BadVBadHealthRanked = dense_rank(desc(BadVBadHealth)),
UnemployedRanked = dense_rank(desc(Unemployed)),
LoneParFamUnitRanked = dense_rank(desc(LoneParentsFamUnits)),
SmokingRanked = dense_rank(desc(T12_4_YES)),
LARanked = dense_rank(desc(T6_3_RLAH)),
OwnedOutrightRanked = dense_rank(desc(T6_3_OOH)),
OutsideIrelandRanked = dense_rank(desc(OutsideIreland)),
UnskilledRanked = dense_rank(desc(T9_1_UST)),
ProfWorkersRanked = dense_rank(desc(T9_1_PWT)),
MalesDisabilityRanked = dense_rank(desc(T12_1_M)),
FemalesDisabilityRanked = dense_rank(desc(T12_1_F)),
MalesCarersRanked = dense_rank(desc(T12_2_M)),
FemalesCarersRanked = dense_rank(desc(T12_2_F)),
VolunteersRanked = dense_rank(desc(T7_1_VOL)),
RenewableEnergyRanked = dense_rank(desc(T6_10_NORE)),
OnFootBicycleRanked = dense_rank(desc(OnFootBicycle)),
CarDriverRanked = dense_rank(desc(T11_1_CDT)),
ZeroTo14Ranked = dense_rank(desc(ZeroTo14)),
SixtyFivePRanked = dense_rank(desc(ZeroTo14))
)
SAPSTotalCHNIHARanked2 <- SAPSTotalCHNIHARanked[SAPSTotalCHNIHARanked$ED == ED,]
PrimaryOrLowerRankedCHNIHA <- SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked
DegreeOrHigherRankedCHNIHA <- SAPSTotalCHNIHARanked2$DegreeOrHigherRanked
BadVBadHealthRankedCHNIHA <- SAPSTotalCHNIHARanked2$BadVBadHealthRanked
UnemployedRankedCHNIHA  <- SAPSTotalCHNIHARanked2$UnemployedRanked
LoneParFamUnitRankedCHNIHA <- SAPSTotalCHNIHARanked2$LoneParFamUnitRanked
SmokingRankedCHNIHA <- SAPSTotalCHNIHARanked2$SmokingRanked
LARankedCHNIHA <- SAPSTotalCHNIHARanked2$LARanked
OwnedOutrightRankedCHNIHA <- SAPSTotalCHNIHARanked2$OwnedOutrightRanked
OutsideIrelandRankedCHNIHA  <- SAPSTotalCHNIHARanked2$OutsideIrelandRanked
UnskilledRankedCHNIHA <-  SAPSTotalCHNIHARanked2$UnskilledRanked
ProfWorkersRankedCHNIHA <- SAPSTotalCHNIHARanked2$ProfWorkersRanked
MalesDisabilityRankedCHNIHA <- SAPSTotalCHNIHARanked2$MalesDisabilityRanked
FemalesDisabilityRankedCHNIHA <- SAPSTotalCHNIHARanked2$FemalesDisabilityRanked
MalesCarersRankedCHNIHA <- SAPSTotalCHNIHARanked2$MalesCarersRanked
FemalesCarersRankedCHNIHA <- SAPSTotalCHNIHARanked2$FemalesCarersRanked
VolunteersRankedCHNIHA  <- SAPSTotalCHNIHARanked2$VolunteersRanked
RenewableEnergyRankedCHNIHA <- SAPSTotalCHNIHARanked2$RenewableEnergyRanked
OnFootBicycleRankedCHNIHA <- SAPSTotalCHNIHARanked2$OnFootBicycleRanked
CarDriverRankedCHNIHA <- SAPSTotalCHNIHARanked2$CarDriverRanked
ZeroTo14RankedCHNIHA <- SAPSTotalCHNIHARanked2$ZeroTo14Ranked
SixtyFivePRankedCHNIHA <- SAPSTotalCHNIHARanked2$SixtyFivePRanked
PrimaryOrLowerRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHNIHA)>1,"Joint","Not Joint")
DegreeOrHigherRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$DegreeOrHigherRanked == DegreeOrHigherRankedCHNIHA)>1,"Joint","Not Joint")
BadVBadHealthRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$BadVBadHealthRanked == BadVBadHealthRankedCHNIHA)>1,"Joint","Not Joint")
UnemployedRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$UnemployedRanked == UnemployedRankedCHNIHA)>1,"Joint","Not Joint")
LoneParFamUnitRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$LoneParFamUnitRanked == LoneParFamUnitRankedCHNIHA)>1,"Joint","Not Joint")
SmokingRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$SmokingRanked  == SmokingRankedCHNIHA)>1,"Joint","Not Joint")
LARankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$LARanked  == LARankedCHNIHA)>1,"Joint","Not Joint")
OwnedOutrightRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$OwnedOutrightRanked == OwnedOutrightRankedCHNIHA)>1,"Joint","Not Joint")
OutsideIrelandRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$OutsideIrelandRanked == OutsideIrelandRankedCHNIHA)>1,"Joint","Not Joint")
UnskilledRankedCHNIHAJoint <-  ifelse(sum(SAPSTotalCHNIHARanked2$UnskilledRanked  == UnskilledRankedCHNIHA)>1,"Joint","Not Joint")
ProfWorkersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$ProfWorkersRanked == ProfWorkersRankedCHNIHA)>1,"Joint","Not Joint")
MalesDisabilityRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$MalesDisabilityRanked == MalesDisabilityRankedCHNIHA)>1,"Joint","Not Joint")
FemalesDisabilityRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$FemalesDisabilityRanked == FemalesDisabilityRankedCHNIHA)>1,"Joint","Not Joint")
MalesCarersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$MalesCarersRanked == MalesCarersRankedCHNIHA)>1,"Joint","Not Joint")
FemalesCarersRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$FemalesCarersRanked == FemalesCarersRankedCHNIHA)>1,"Joint","Not Joint")
VolunteersRankedCHNIHAJoint  <- ifelse(sum(SAPSTotalCHNIHARanked2$VolunteersRanked == VolunteersRankedCHNIHA)>1,"Joint","Not Joint")
RenewableEnergyRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$RenewableEnergyRanked  == RenewableEnergyRankedCHNIHA)>1,"Joint","Not Joint")
OnFootBicycleRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$OnFootBicycleRanked  == OnFootBicycleRankedCHNIHA)>1,"Joint","Not Joint")
CarDriverRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$CarDriverRanked  == CarDriverRankedCHNIHA)>1,"Joint","Not Joint")
ZeroTo14RankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$ZeroTo14Ranked  == ZeroTo14RankedCHNIHA)>1,"Joint","Not Joint")
SixtyFivePRankedCHNIHAJoint <- ifelse(sum(SAPSTotalCHNIHARanked2$SixtyFivePRanked == SixtyFivePRankedCHNIHA)>1,"Joint","Not Joint")
################################
SAPSTotalCHNRanked2 <- SAPSTotalCHNRanked[SAPSTotalCHNRanked$ED == ED,]
PrimaryOrLowerRankedCHN <- SAPSTotalCHNRanked2$PrimaryOrLowerRanked
DegreeOrHigherRankedCHN <- SAPSTotalCHNRanked2$DegreeOrHigherRanked
BadVBadHealthRankedCHN <- SAPSTotalCHNRanked2$BadVBadHealthRanked
UnemployedRankedCHN  <- SAPSTotalCHNRanked2$UnemployedRanked
LoneParFamUnitRankedCHN <- SAPSTotalCHNRanked2$LoneParFamUnitRanked
SmokingRankedCHN <- SAPSTotalCHNRanked2$SmokingRanked
LARankedCHN <- SAPSTotalCHNRanked2$LARanked
OwnedOutrightRankedCHN <- SAPSTotalCHNRanked2$OwnedOutrightRanked
OutsideIrelandRankedCHN  <- SAPSTotalCHNRanked2$OutsideIrelandRanked
UnskilledRankedCHN <-  SAPSTotalCHNRanked2$UnskilledRanked
ProfWorkersRankedCHN <- SAPSTotalCHNRanked2$ProfWorkersRanked
MalesDisabilityRankedCHN <- SAPSTotalCHNRanked2$MalesDisabilityRanked
FemalesDisabilityRankedCHN <- SAPSTotalCHNRanked2$FemalesDisabilityRanked
MalesCarersRankedCHN <- SAPSTotalCHNRanked2$MalesCarersRanked
FemalesCarersRankedCHN <- SAPSTotalCHNRanked2$FemalesCarersRanked
VolunteersRankedCHN  <- SAPSTotalCHNRanked2$VolunteersRanked
RenewableEnergyRankedCHN <- SAPSTotalCHNRanked2$RenewableEnergyRanked
OnFootBicycleRankedCHN <- SAPSTotalCHNRanked2$OnFootBicycleRanked
CarDriverRankedCHN <- SAPSTotalCHNRanked2$CarDriverRanked
ZeroTo14RankedCHN <- SAPSTotalCHNRanked2$ZeroTo14Ranked
SixtyFivePRankedCHN <- SAPSTotalCHNRanked2$SixtyFivePRanked
PrimaryOrLowerRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$PrimaryOrLowerRanked == PrimaryOrLowerRankedCHN)>1,"Joint","Not Joint")
DegreeOrHigherRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$DegreeOrHigherRanked == DegreeOrHigherRankedCHN)>1,"Joint","Not Joint")
BadVBadHealthRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$BadVBadHealthRanked == BadVBadHealthRankedCHN)>1,"Joint","Not Joint")
UnemployedRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$UnemployedRanked == UnemployedRankedCHN)>1,"Joint","Not Joint")
LoneParFamUnitRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$LoneParFamUnitRanked == LoneParFamUnitRankedCHN)>1,"Joint","Not Joint")
SmokingRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$SmokingRanked  == SmokingRankedCHN)>1,"Joint","Not Joint")
LARankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$LARanked  == LARankedCHN)>1,"Joint","Not Joint")
OwnedOutrightRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$OwnedOutrightRanked == OwnedOutrightRankedCHN)>1,"Joint","Not Joint")
OutsideIrelandRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$OutsideIrelandRanked == OutsideIrelandRankedCHN)>1,"Joint","Not Joint")
UnskilledRankedCHNJoint <-  ifelse(sum(SAPSTotalCHNRanked2$UnskilledRanked  == UnskilledRankedCHN)>1,"Joint","Not Joint")
ProfWorkersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$ProfWorkersRanked == ProfWorkersRankedCHN)>1,"Joint","Not Joint")
MalesDisabilityRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$MalesDisabilityRanked == MalesDisabilityRankedCHN)>1,"Joint","Not Joint")
FemalesDisabilityRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$FemalesDisabilityRanked == FemalesDisabilityRankedCHN)>1,"Joint","Not Joint")
MalesCarersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$MalesCarersRanked == MalesCarersRankedCHN)>1,"Joint","Not Joint")
FemalesCarersRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$FemalesCarersRanked == FemalesCarersRankedCHN)>1,"Joint","Not Joint")
VolunteersRankedCHNJoint  <- ifelse(sum(SAPSTotalCHNRanked2$VolunteersRanked == VolunteersRankedCHN)>1,"Joint","Not Joint")
RenewableEnergyRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$RenewableEnergyRanked  == RenewableEnergyRankedCHN)>1,"Joint","Not Joint")
OnFootBicycleRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$OnFootBicycleRanked  == OnFootBicycleRankedCHN)>1,"Joint","Not Joint")
CarDriverRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$CarDriverRanked  == CarDriverRankedCHN)>1,"Joint","Not Joint")
ZeroTo14RankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$ZeroTo14Ranked  == ZeroTo14RankedCHN)>1,"Joint","Not Joint")
SixtyFivePRankedCHNJoint <- ifelse(sum(SAPSTotalCHNRanked2$SixtyFivePRanked == SixtyFivePRankedCHN)>1,"Joint","Not Joint")
NumCHNs <- length(unique(SAPSHRLookup$CHN))
NumCHNIHA <- length(unique(SAPSHRLookup$CHN[SAPSHRLookup$IHA == IHA]))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Create the .RNW file using sweave for compiling
Sweave("HealthProfileTemplate.Rnw",output=gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
#Compile the .rnw with Latex
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
tools::texi2pdf(gsub("--","-",paste0(i,"-",EDLC,"-ac-",ACLC,".tex")))
